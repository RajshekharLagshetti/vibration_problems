clc;
clear all;
n=5;
E=207*10^9;
I=((1/12)*(0.05)*(0.01^3));
rho=7850;
A=0.01*0.05;
L=0.6;
l=L/n;
k=(E*I/(l^3))*[12,6*l,-12,6*l;6*l,(4*l*l),-6*l,2*l*l;-12,-6*l,12,-6*l;6*l,2*l*l,-6*l,4*l*l];
m=((rho*A*l)/420)*[156,22*l,54,-13*l;22*l,4*l*l,13*l,-3*1*l;54,13*l,156,-22*l;-13*l,-3*l*l,-22*l,4*l*l];
K=zeros(2*(n+1));
M=zeros(2*(n+1));
for e=1:n
K(2*e-1:2*e+2,2*e-1:2*e+2)=K(2*e-1:2*e+2,2*e-1:2*e+2)+k(1:4,1:4);
M(2*e-1:2*e+2,2*e-1:2*e+2)=M(2*e-1:2*e+2,2*e-1:2*e+2)+m(1:4,1:4);
end
K(1:2,:)=[];
K(:,1:2)=[];
M(1:2,:)=[];
M(:,1:2)=[];
[V,D]=eig(K,M);
V(2:2:2*n,:)=[];
V=[zeros(1,2*n);V];
W=eig(K,M);
w=sqrt(W)
for i=1:2
    plot(0:l:L,V(:,i));
    hold on;
end
beta=[1.875,4.693,7.85,10.99];
for i=1:4
    wexact(i)=(((beta(i))^2)*(sqrt((E*I)/(rho*A*(L^4)))));
    wexact=wexact'
end


